{% load static %}
<!DOCTYPE html>
<html>
	<head>
	<title>Payment Page</title>
	<meta name="viewport" content="width=device-width, initial-scale=0.8" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link href='http://fonts.googleapis.com/css?family=Allan:bold' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Cardo' rel='stylesheet' type='text/css'>
	<link href="https://fonts.googleapis.com/css?family=Lato:700" rel="stylesheet">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">
	<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.0/css/bootstrap-toggle.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.8.0/css/bootstrap-slider.min.css" />
	<link rel="stylesheet" type="text/css" href="{% static 'orders/stylesheet/style.css' %}" />
	<link rel="stylesheet" type="text/css" href="{% static 'Foodhub/stylesheet/style.css' %}" />
	</head>

{% csrf_token %}
<script type="text/javascript">
// using jQuery
var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
});
</script>	
<body style="background: #efefef;">
<div class="paymentWrapper">
<div class="paymentSubWrapper">
<div class="f-container">
<div class="restaurantOptions">
	<div class="paymentTitle">
 	<h3 class="title-top">Enter Your Payment Information</h3>
 	</div>
	<br>
	<div class="s-row center-block centerContent">
	<img src ="{%static 'orders/images/creditCardicons/Dark/visa.png' %}" width=30px height=30px alt="visa" title="visa">
	<img src ="{%static 'orders/images/creditCardicons/Dark/mastercard.png' %}" width=30px height=30px alt="mastercard" title="mastercard">
	<img src ="{%static 'orders/images/creditCardicons/Dark/maestro.png' %}" width=30px height=30px alt="maestro" title="maestro">
	<img src ="{%static 'orders/images/creditCardicons/Dark/amex.png' %}" width=30px height=30px alt="amex" title="American Express">
	<img src ="{%static 'orders/images/creditCardicons/Dark/dClub.png' %}" width=30px height=30px alt="amex" title="Diners Club">
	</div>
	<br>
	<div class="order-body">
	<form action='{% url "orders:chargeCard" %}' method="post" id="payment-form">{% csrf_token %}
	  <div class="userSection">
		  <div class="form-row">
		    <label class="paymentTitle" for="card-element">
		      Credit or debit card
		    </label>
		    <div id="card-element">
		      <!-- a Stripe Element will be inserted here. -->
		    </div>

		    <!-- Used to display form errors -->
		    <div id="card-errors" role="alert"></div>
		  </div>
		  <br>
		  <div class="billingInfo">
		  	<div class="s-row billingHeader">
			    <span class="sectionHeader paymentTitle">Billing Information</span>
			</div>
			<div class="s-row">
			    <div class="col-sm-6">
			      <div class="input-block">
			        <input class="orderInput" name ="firstName" id ="firstName" type="text">
			        <label for ="firstName" class="inputLabel">First Name</label>
			      </div>
			    </div>
			    <div class="col-sm-6">
			      <div class="input-block">
			        <input class="orderInput" name ="lastName" id ="lastName" type="text">
			        <label for ="lastName" class="inputLabel">Last Name</label>
			      </div>
			    </div>
			  </div>
			  <div class="s-row">
			  	<div class="col-sm-12">
				  	<div class="input-block">
			          <input class="orderInput" name ="address_line1" id ="address_line1" type="text">
			          <label for ="address_line1" class="inputLabel">Address</label>
			        </div>
		        </div>
			  </div>
			  <div class="s-row">
			  	<div class="col-sm-12">
				  	<div class="input-block">
			          <input class="orderInput" name ="address_line2" id ="address_line2" type="text">
			        </div>
		        </div>
			  </div>
			  <div class="s-row">
			  	<div class="col-sm-6">
				  	<div class="input-block">
			          <input class="orderInput" name ="address_city" id ="address_city" type="text">
			          <label for ="address_city" class="inputLabel">City</label>
			        </div>
		        </div>
		        <div class="col-sm-6">
				  	<div class="input-block">
			          <select class="orderInput" name ="address_state" id ="address_state">
			            <option value="AL">Alabama</option>
			            <option value="AK">Alaska</option>
			            <option value="AZ">Arizona</option>
			            <option value="AR">Arkansas</option>
			            <option value="CA">California</option>
			            <option value="CO">Colorado</option>
			            <option value="CT">Connecticut</option>
			            <option value="DE">Delaware</option>
			            <option value="DC">District Of Columbia</option>
			            <option value="FL">Florida</option>
			            <option value="GA">Georgia</option>
			            <option value="HI">Hawaii</option>
			            <option value="ID">Idaho</option>
			            <option value="IL">Illinois</option>
			            <option value="IN">Indiana</option>
			            <option value="IA">Iowa</option>
			            <option value="KS">Kansas</option>
			            <option value="KY">Kentucky</option>
			            <option value="LA">Louisiana</option>
			            <option value="ME">Maine</option>
			            <option value="MD">Maryland</option>
			            <option value="MA">Massachusetts</option>
			            <option value="MI">Michigan</option>
			            <option value="MN">Minnesota</option>
			            <option value="MS">Mississippi</option>
			            <option value="MO">Missouri</option>
			            <option value="MT">Montana</option>
			            <option value="NE">Nebraska</option>
			            <option value="NV">Nevada</option>
			            <option value="NH">New Hampshire</option>
			            <option value="NJ">New Jersey</option>
			            <option value="NM">New Mexico</option>
			            <option value="NY">New York</option>
			            <option value="NC">North Carolina</option>
			            <option value="ND">North Dakota</option>
			            <option value="OH">Ohio</option>
			            <option value="OK">Oklahoma</option>
			            <option value="OR">Oregon</option>
			            <option value="PA">Pennsylvania</option>
			            <option value="RI">Rhode Island</option>
			            <option value="SC">South Carolina</option>
			            <option value="SD">South Dakota</option>
			            <option value="TN">Tennessee</option>
			            <option value="TX">Texas</option>
			            <option value="UT">Utah</option>
			            <option value="VT">Vermont</option>
			            <option value="VA">Virginia</option>
			            <option value="WA">Washington</option>
			            <option value="WV">West Virginia</option>
			            <option value="WI">Wisconsin</option>
			            <option value="WY">Wyoming</option>
			            <option value="AS">American Samoa</option>
			            <option value="GU">Guam</option>
			            <option value="MP">Northern Mariana Islands</option>
			            <option value="PR">Puerto Rico</option>
			            <option value="UM">United States Minor Outlying Islands</option>
			            <option value="VI">Virgin Islands</option>
			            <option value="AA">Armed Forces Americas</option>
			            <option value="AP">Armed Forces Pacific</option>
			            <option value="AE">Armed Forces Others</option> 
			          </select>
			           <label for ="address_state" class="inputLabel">State</label>
			        </div>
		        </div>
			  </div>
			  <div class="s-row">
			  	<div class="col-sm-6">
				  	<div class="input-block">
			          <input class="orderInput" name ="address_country" id ="address_country" type="text">
			          <label for ="address_country" class="inputLabel">Phone Number</label>
			        </div>
		        </div>

			  	<div class="col-sm-6">
				  	<div class="input-block">
			          <input class="orderInput" name ="address_zip" id ="address_zip" type="text">
			          <label for ="address_zip" class="inputLabel">Zip Code</label>
			        </div>
		        </div>
		        
			  </div>
			  <div class="s-row">
			  <div class="col-sm-6">
				  	<div class="input-block">
			          <input class="orderInput" name ="phone" id ="phone" type="text">
			          <label for ="phone" class="inputLabel">Phone Number</label>
			        </div>
		        </div>
			  <div class="col-sm-6">
			  	<div class="input-block">
				  	<input class="orderInput" name ="email" id ="phone" type="email">
				    <label for ="email" class="inputLabel">Email</label>
			    </div>
			  </div>
			  </div>
		  </div>
		  <br>
		  <button class="btn btn-primary viewbutton home-btn center-block btn-lg">Submit Payment</button>
	  </div>
	</form>
	</div>
</div>
</div>
</div>
</div>
</body>
<script src="https://js.stripe.com/v3/"></script>
<script type="text/javascript">
	var stripe = Stripe('pk_test_ki39i5Y0q8vBbOrfeqI3yF1P');
	var elements = stripe.elements();

	var style = {
	  base: {
	    color: '#32325d',
	    lineHeight: '24px',
	    fontFamily: '"Helvetica Neue", Helvetica, sans-serif',
	    fontSmoothing: 'antialiased',
	    fontSize: '16px',
	    '::placeholder': {
	      color: '#aab7c4'
	    }
	  },
	  invalid: {
	    color: '#fa755a',
	    iconColor: '#fa755a'
	  }
	};
	var card = elements.create('card', {style: style});
		card.mount('#card-element');

	// Handle real-time validation errors from the card Element.
	card.addEventListener('change', function(event) {
	  var displayError = document.getElementById('card-errors');
	  if (event.error) {
	    displayError.textContent = event.error.message;
	  } else {
	    displayError.textContent = '';
	  }
	});

	// Handle form submission
	var form = document.getElementById('payment-form');
	form.addEventListener('submit', function(event) {
	  event.preventDefault();

	  stripe.createToken(card).then(function(result) {
	    if (result.error) {
	      // Inform the user if there was an error
	      var errorElement = document.getElementById('card-errors');
	      errorElement.textContent = result.error.message;
	    } else {
	      // Send the token to your server
	      stripeTokenHandler(result.token);
	    }
	  });
	});
	function stripeTokenHandler(token) {
  // Insert the token ID into the form so it gets submitted to the server
	  var form = document.getElementById('payment-form');
	  var hiddenInput = document.createElement('input');
	  hiddenInput.setAttribute('type', 'hidden');
	  hiddenInput.setAttribute('name', 'stripeToken');
	  hiddenInput.setAttribute('value', token.id);
	  form.appendChild(hiddenInput);

	  // Submit the form
	  form.submit();
	}
</script>
</html>